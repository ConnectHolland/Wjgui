if("undefined"==typeof Translate)var Translate={_translations:{},_defaultLanguage:"en_US",_currentLanguage:"en_US",setLanguage:function(language){Translate._currentLanguage=language},setLanguageFromDocument:function(){var lang=document.documentElement.lang;switch(lang){case"en":lang="en_US";case"nl":lang="nl_NL";case"fr":lang="fr_FR"}return Translate.setLanguage(lang)},addLanguage:function(language,translations,domain){var domain=domain||"__messages";"undefined"==typeof Translate._translations[language]&&(Translate._translations[language]={}),"undefined"==typeof Translate._translations[language][domain]&&(Translate._translations[language][domain]={}),Translate._translations[language][domain]=translations},lookup:function(key,domain){var domain=domain||"__messages",translations=Translate._translations[Translate._currentLanguage]||Translate._translations[Translate._defaultLanguage];return"undefined"==typeof translations?domain+"_"+key:domain in translations==!1?domain+"_"+key:translations[domain][key]}};Translate.setLanguageFromDocument(),Translate.addLanguage("en_US",{OK:"OK",CANCEL:"Cancel",YES:"Yes",NO:"No",CLOSE_WINDOW:"Close window"},"wjgui"),Translate.addLanguage("nl_NL",{OK:"Ok",CANCEL:"Annuleren",YES:"Ja",NO:"Nee",CLOSE_WINDOW:"Venster sluiten"},"wjgui");var WJGuiSettings=Object.extend({windowBaseTitle:"Windmill CMS"},WJGuiSettings||{}),WJWindow=Class.create({initialize:function(callback,parent,translate){this._loading=!1,this._basetitle=this._title="",this._theme="default",this._parent=parent||WJWindow.DEFAULT_PARENT||document.body,Element.extend(this._parent),this._listeners=new Hash,this.translate=translate||this.translate,this._createWindow(),this._addDefaultListeners(),this._addCloseButton(),this.setCallback(callback),this.setBaseTitle(WJGuiSettings.windowBaseTitle)},_createWindow:function(){var classname=this._getBaseClassname();this._windowElement=new Element("div"),this._windowElement.addClassName(classname),this._windowElement.setStyle({display:"none"}),this._createWindowRows(["title","main","buttons","bottom"],classname),this._windowElementId=this._windowElement.identify(),this._parent.insert(this._windowElement),this._absolutizeTopLeft(),this.hide(),this._outerElement=this._windowElement,this.setTheme()},insertWindowRowBefore:function(rowname,newrowname){if("title"!==rowname){var classname=this._getBaseClassname(),row=this._windowElement.select("."+classname+"_"+rowname);row=row.first();var newrowhtml=this._createRow(newrowname,classname," "+classname+"_body"),div=new Element("div");div.update(newrowhtml);var toprow=row.parentNode,newrow=toprow.insertBefore(div.firstChild,row);return newrow=Element.extend(newrow),newrow=newrow.select("."+classname+"_content"),this._contentElements[newrowname]=newrow.first(),newrow}},replaceWindowRow:function(oldrow,newrow){var toremove=(this.insertWindowRowBefore(oldrow,newrow),this.getContentElement(oldrow));return this._contentElements[oldrow]=this._contentElements[newrow],toremove.remove()},removeWindowRow:function(oldrow){var toremove=this.getContentElement(oldrow);return delete this._contentElements[oldrow],toremove.remove()},_addCloseButton:function(){var title=this.getContentElement("title"),titlediv=new Element("div",{onclick:"this.parentNode.getWJWindowObject().fireClose(this)",title:this.translate("CLOSE_WINDOW")});titlediv.addClassName(this._getBaseClassname()+"_closebutton"),title.insert(titlediv)},fireClose:function(element){element=$(element);var func=function(){this.destroy(),Event.stopObserving(document,"wjgui:close",arguments.callee.observerFunction)},bound=func.bindAsEventListener(this);func.observerFunction=bound,Event.observe(document,"wjgui:close",bound),element.fire("wjgui:close"),Event.stopObserving.defer(document,"wjgui:close",bound)},_addDefaultListeners:function(element){this.addListener("true",this.windowResult.bindAsEventListener(this,!0)),this.addListener("false",this.windowResult.bindAsEventListener(this,!1)),this.addListener("close",this.windowResult.bindAsEventListener(this,!1)),this.addListener("save",this.windowResult.bindAsEventListener(this)),this.addListener("delete",this.windowResult.bindAsEventListener(this)),this.addListener("cancel",this.windowResult.bindAsEventListener(this)),this._addDefaultKeyListener()},_addDefaultKeyListener:function(){var element=element||this._windowElement;Event.observe(element,"keydown",this.keyHandle.bindAsEventListener(this))},keyHandle:function(event){var element=event.element();if(Object.isElement(element.up(".wjgui_window")))switch(event.keyCode){case Event.KEY_RETURN:this.isVisible()&&element.fire("wjgui:true");break;case Event.KEY_ESC:this.isVisible()&&element.fire("wjgui:close");break;default:return}},addListener:function(eventName,callback,element){this._log("INFO","Adding listener in WJWindow",eventName,callback);var callback=callback||this.windowResult.bindAsEventListener(this),element=element||this._windowElement;return Event.observe(element,"wjgui:"+eventName,callback),this._setListener(eventName,{element:element,callback:callback}),this},_log:function(level){return"undefined"!=typeof WJDebugger?(arguments[0]=WJDebugger[level],WJDebugger.log.apply(this,arguments)):void 0},_setListener:function(key,elementAndCallback){this._listeners.set(key,elementAndCallback)},removeListener:function(key){var listener=this.getListener(key);return Event.stopObserving(listener.element,"wjgui:"+key,listener.callback),this._listeners.unset(key),this},removeListeners:function(){return this._listeners.each(function(info){this.removeListener(info.key)}.bind(this)),this},windowResult:function(event){this._callback.apply(this,arguments)},getListeners:function(){return this._listeners},getListener:function(key){return this._listeners.get(key)},_getBaseClassname:function(){return"wjgui_window"},_getWindowRowTemplate:function(){return new Template("<div class='#{classprefix}_#{rowname} #{classprefix}_row#{body}'><div class='#{classprefix}_left #{classprefix}_column'><div class='#{classprefix}_right #{classprefix}_column'><div class='#{classprefix}_center #{classprefix}_column'><div class='#{classprefix}_content'>&#160;</div></div></div></div></div>")},_createWindowRows:function(rows,classprefix,windowElement){var windowElement=windowElement||this._windowElement;rows.each(function(windowElement,classprefix,rowname,index){var body=" "+classprefix+"_body";(0==index||index==rows.length-1)&&(body=""),windowElement.innerHTML+=this._createRow(rowname,classprefix,body)}.bind(this,windowElement,classprefix)),this._saveRows(rows,classprefix,windowElement),this._addWindowObjectGetters()},_addWindowObjectGetters:function(){var test=[$H(this._contentElements).values(),this._windowElement].flatten();return test.each(function(el){el.getWJWindowObject=function(){return this}.bind(this)},this),test},_saveRows:function(rows,classprefix,windowElement){var windowElement=windowElement||this._windowElement;return this._contentElements={},rows.each(function(windowElements,rowname,index){this._contentElements[rowname]=windowElements[index]}.bind(this,windowElement.select("."+classprefix+"_content"))),this},_createRow:function(rowname,classprefix,body){var row=this._getWindowRowTemplate();return row.evaluate({rowname:rowname,classprefix:classprefix,body:body})},getContentElement:function(rowname){return this._contentElements[rowname]},evalContentElement:function(rowname){var element=this.getContentElement(rowname);return element.innerHTML.evalScripts(),this},_absolutizeTopLeft:function(element){var element=element||this._windowElement;element.absolutize(),element.setStyle({height:"",width:""}),this.setX(0,element),this.setY(0,element)},_checkMaxHeight:function(element){var element=element||this.getContentElement("main");this.getY()+this.getHeight()>document.viewport.getHeight()?this.setHeight(document.viewport.getHeight()-this.getY(),element,!1):element.setStyle({maxHeight:""})},show:function(element){var element=element||this._outerElement||this._windowElement;element.style.display="block";try{element.focus()}catch(e){}return this},hide:function(element){var element=element||this._outerElement||this._windowElement;return element.style.display="none",this},destroy:function(element){var element=element||this._outerElement||this._windowElement;return element.parentNode&&element.remove(),this},_callback:function(){if(Object.isFunction(this._callbackFunction)){var args=$A(arguments);return args.unshift(this),this._callbackFunction.apply(this._callbackFunction,args)}},_close:function(event){this.hide()},setBaseTitle:function(title){return this._basetitle=title,this.setTitle(this.getTitle()),this},setTitle:function(title){this._title=title;var headers=this.getContentElement("title").getElementsByTagName("h1");return headers.length<1?(this.getContentElement("title").innerHTML="<h1>&#160;</h1>"+this.getContentElement("title").innerHTML,this.setTitle(this._title)):(headers[0].innerHTML=this._getComposedTitle(),this)},_getComposedTitle:function(){return this._title+(""!=this._basetitle&&this._basetitle!=this._title?(""!=this._title?" - ":"")+this._basetitle:"")},setContent:function(content){return Object.isString(content)&&(this.getContentElement("main").innerHTML=content),Object.isElement(content)&&this.getContentElement("main").appendChild(content),this._content=content,this},addButton:function(caption,eventHandler,defaultButton){this._log("INFO","Adding button to window",caption,eventHandler,this);var button=WJButton.create(caption,eventHandler,defaultButton,this.getContentElement("buttons"));return this._checkMaxHeight(),button},addStatusbar:function(){this._log("INFO","Adding statusbar to window",this),this._statusbar=new Element("div"),this._statusbar.addClassName("wjgui_statusbar"),this.getContentElement("buttons").insert(this._statusbar),this._checkMaxHeight()},setStatusbar:function(content,fade){var fade=fade||-1;this._statusbar&&(this._statusbar.update(content),fade>0&&this.hideStatusbar.bind(this).delay(fade))},hideStatusbar:function(){"undefined"!=typeof S2?this._statusbar.fade({duration:3}):"undefined"!=typeof Effect&&Effect.Fade(this._statusbar,{duration:3}),this.clearAndShowStatusbar.bind(this).delay(3.5)},clearAndShowStatusbar:function(){this._statusbar.update(""),this._statusbar.show()},setCallback:function(callback){return Object.isFunction(callback)&&(this._callbackFunction=callback),this},setX:function(x,element){this._x=x||0;var element=element||this._windowElement;return element.style.left=x+"px",this},setY:function(y,element){this._y=y||0;var element=element||this._windowElement;return element.style.top=y+"px",this._checkMaxHeight(element),this},setZ:function(z,element){this._z=z||1e4;var element=element||this._windowElement;return element.style.zIndex=z,this},setWidth:function(width,element){this._width=width;var element=element||this._windowElement;return element.setStyle({width:width+"px"}),element.fire("wjgui:resize"),this},setHeight:function(height,element,checkHeight){this._height=height;var element=element||this.getContentElement("main"),wasVisible=this.isVisible(),origX=this.getX(),origY=this.getY();wasVisible||(this.setX(-1e4),this.setY(-1e4),this.show());var otherRowsHeight=0;for(var key in this._contentElements)"main"!=key&&(otherRowsHeight+=this._contentElements[key].getHeight());var height=0==Object.isNumber(height)?height:height-otherRowsHeight+"px";return element.setStyle({height:height}),wasVisible||(this.hide(),this.setX(origX),this.setY(origY)),0!=checkHeight&&this._checkMaxHeight(element),checkHeight||element.fire("wjgui:resize"),this},getBaseTitle:function(){return this._basetitle},getTitle:function(){return this._title},getType:function(){return this._type},getContent:function(){return this._content},getContenttype:function(){},getCallback:function(){return this._callbackFunction},isVisible:function(){var xInLow=this.getX()<0&&this.getX()+this.getWidth()>0,xInHigh=this.getX()>=0&&this.getX()<document.viewport.getWidth(),yInLow=this.getY()<0&&this.getY()+this.getHeight()>0,yInHigh=this.getY()>=0&&this.getY()<document.viewport.getHeight();return(xInLow||xInHigh)&&(yInLow||yInHigh)&&this._windowElement.visible()?!0:!1},getX:function(element){var element=element||this._windowElement;return parseInt(element.style.left)},getY:function(element){var element=element||this._windowElement;return parseInt(element.style.top)},getZ:function(){var element=element||this._windowElement;return element.style.zIndex},getWidth:function(element){var element=element||this._windowElement;return element.getWidth()},getHeight:function(element){var element=element||this._windowElement;return element.getHeight()},getContentHeight:function(){return this.getContentElement("main").getHeight()},getContentWidth:function(){return this.getContentElement("main").getWidth()},getWindowElement:function(){return this._windowElement},center:function(element){var element=element||this._windowElement,remainsX=document.viewport.getWidth()-this.getWidth(element),remainsY=document.viewport.getHeight()-this.getHeight(element);return this.setX(remainsX/2,element).setY(remainsY/2,element),this},keepCentered:function(element){if(!this._centerObserver){var element=element||this._windowElement;this._centerObserver=this.center.bind(this,element),Event.observe(window,"resize",this._centerObserver)}return this},stopCentered:function(){return Event.stopObserving(window,"resize",this._centerObserver),this._centerObserver=null,this},maximize:function(paddingTop,paddingRight,paddingBottom,paddingLeft,noScroll){var paddingTop=paddingTop||0,paddingRight=paddingRight||paddingTop,paddingBottom=paddingBottom||paddingTop,paddingLeft=paddingLeft||paddingTop,noScroll=noScroll||!1;return this.setX(paddingLeft).setY(paddingTop),noScroll&&this.setWidth(0).setHeight(0),this.setWidth(document.viewport.getWidth()-(paddingLeft+paddingRight)).setHeight(document.viewport.getHeight()-(paddingTop+paddingBottom)),this},keepMaximized:function(){if(!this._maximizedObserver){var paddingTop=this.getY(),paddingLeft=this.getX(),paddingRight=document.viewport.getWidth()-this.getWidth()-paddingLeft,paddingBottom=document.viewport.getHeight()-this.getHeight()-paddingTop;this._maximizedObserver=this.maximize.bind(this,paddingTop,paddingRight,paddingBottom,paddingLeft,!0),Event.observe(window,"resize",this._maximizedObserver)}return this},stopMaximized:function(){return Event.stopObserving(window,"resize",this._maximizedObserver),this._maximizedObserver=null,this},setLoading:function(loading,loadCallback){var loadCallback=loadCallback||!1;return loading&&!this.getLoading()?(this.getWindowElement().addClassName("wjgui_window_loading"),loadCallback?loadCallback(this,loading):this.getContentElement("main").setStyle({visibility:"hidden"})):!loading&&this.getLoading()&&(this.getWindowElement().removeClassName("wjgui_window_loading"),loadCallback?loadCallback(this,loading):this.getContentElement("main").setStyle({visibility:"visible"})),this._loading=loading,this},getLoading:function(){return this._loading},setTheme:function(theme){return theme==this.getTheme()?this:(this._removeOldTheme(),this._setTheme(theme),this._addNewTheme(),this)},_setTheme:function(theme){this._theme=theme||"default"},_removeOldTheme:function(){this.getWindowElement().removeClassName(this._getBaseClassname()+"theme_"+this.getTheme())},_addNewTheme:function(){this.getWindowElement().addClassName(this._getBaseClassname()+"theme_"+this.getTheme())},getTheme:function(){return this._theme},translate:function(key){return Translate.lookup(key,"wjgui")}});document.observe("dom:loaded",function(){WJWindow.DEFAULT_PARENT||(WJWindow.DEFAULT_PARENT=document.body)}),WJWindow._messagedialog=function(type,message,callback,show,translate,allowHTML){var win=new WJWindow(callback,null,translate),mwin=new window[type](win);return mwin.setMessage(message,allowHTML),show&&mwin.show(),mwin},WJWindow.alert=function(message,callback,translate,allowHTML){return WJWindow._messagedialog("WJWindowAlert",message,callback,!0,translate,allowHTML)},WJWindow.notice=function(message,callback,translate,allowHTML){return WJWindow._messagedialog("WJWindowNotice",message,callback,!0,translate,allowHTML)},WJWindow.confirm=function(message,callback,translate,allowHTML){return WJWindow._messagedialog("WJWindowConfirm",message,callback,!0,translate,allowHTML)},WJWindow.booleanConfirm=function(message,callback,translate,allowHTML){return WJWindow._messagedialog("WJWindowBooleanConfirm",message,callback,!0,translate,allowHTML)},WJWindow.prompt=function(message,callback,translate,allowHTML){return WJWindow._messagedialog("WJWindowPrompt",message,callback,!0,translate,allowHTML)};var WJWindowModal=Class.create({initialize:function(toDecorate){this._decorate(toDecorate),this._createModalLayer(),this._maxblink=6,this._addBlinkListener(),this._rebindListeners(),this._rebindWindowObjectGetters(),this.setZ(2147483647),this.showOnInit()},showOnInit:function(){this.show()},_decorate:function(toDecorate){this._decorated=toDecorate;for(property in this._decorated)Object.isFunction(this[property])||(this[property]=this._decorated[property])},_rebindListeners:function(){this.removeListeners(),this._addDefaultListeners()},_createModalLayer:function(){var windowElement=this._decorated.getWindowElement();this._getModallayerInstance().getLayer().insert(windowElement),this._outerElement=this._modalLayer.getLayer()},_getModallayerInstance:function(){return"undefined"==typeof this._modalLayer&&(this._modalLayer=new WJModalLayer),this._modalLayer},show:function(element){var element=element||this._outerElement||this._modalLayer.getLayer();return element.style.display="block",this._setBodyOverflow("hidden"),this._decorated.show(),this},hide:function(element){var element=element||this._outerElement||this._modalLayer.getLayer();return element.style.display="none",this._setBodyOverflow(),this._decorated.hide(),this},_setBodyOverflow:function(value){var value=value||"";$(document.body).setStyle({overflow:value}),$(document.getElementsByTagName("html")[0]).setStyle({overflow:value})},_addBlinkListener:function(){Event.observe(this._modalLayer.getLayer(),"click",this.blink.bindAsEventListener(this))},blink:function(event,doBlink,count){var count=count||0;Event.element(event).className==this._getBaseClassname()+"_modality"&&(doBlink?(this.getWindowElement().addClassName(this._getBaseClassname()+"_blink"),doBlink=!1):(this.getWindowElement().removeClassName(this._getBaseClassname()+"_blink"),doBlink=!0),count<this._maxblink&&(count++,this.blink.bind(this,event,doBlink,count).delay(.05)))},_rebindWindowObjectGetters:function(){var els=this._decorated._addWindowObjectGetters();return els.each(function(el){el.getWJWindowObject=el.getWJWindowObject.bind(this)},this),els}}),WJWindowMessageDialog=Class.create(WJWindowModal,{initialize:function($super,toDecorate){$super(toDecorate),this.center(),this.keepCentered(),this._drawDefaultContent(),this._buttons=null,this._addButtons()},_drawDefaultContent:function(){var content=this.getContentElement("main"),replaces=this._getTemplateValues(),template=this._getTemplate();content.innerHTML=template.evaluate(replaces),this._contentElements.message=content.down("."+replaces.classprefix+"_message")},_getTemplateValues:function(){return{classprefix:this._getBaseClassname(),windowtype:this._type}},_addButtons:function(){return null==this._buttons&&(this._buttons=new Hash,this._buttons.set("ok",WJButton.create(this._decorated.translate("OK"),"true",!0,this.getContentElement("buttons"))).focus()),this._buttons},_getTemplate:function(){return new Template("<div class='#{classprefix}_messageicon #{classprefix}_messageicon_#{windowtype}'>&#160;</div><div class='#{classprefix}_message'>&#160;</div>")},setMessage:function(message,allowHTML){var allowHTML=!!allowHTML;allowHTML||(message=message.stripTags()),this.message=message.stripScripts().split("\n").join("<br/>"),this.getContentElement("message").innerHTML=this.message},_callback:function(){return this.hide(),this._decorated._callback.apply(this._decorated,$A(arguments))}}),WJWindowAlert=Class.create(WJWindowMessageDialog,{initialize:function($super,toDecorate){this._type||(this._type="alert"),$super(toDecorate),this.getListener("close").callback.setArgument(0,!0),this.removeListener("false"),this.removeListener("save"),this.removeListener("cancel")}}),WJWindowConfirm=Class.create(WJWindowMessageDialog,{initialize:function($super,toDecorate){"undefined"==typeof this._type&&(this._type="confirm"),$super(toDecorate)},_addButtons:function($super){return this._buttons=$super(),this._buttons.set("cancel",WJButton.create(this._decorated.translate("CANCEL"),"false",!1,this.getContentElement("buttons"))),this._buttons}}),WJButton=Class.create({initialize:function(caption,eventHandler,defaultButton,parentElement){this._log("INFO","Create new button",caption,eventHandler,defaultButton,parentElement),this._caption=caption,this._eventHandler=eventHandler,this._defaultButton=defaultButton===!0?!0:!1,this._parentElement=$(parentElement),this._buildEventHandler(),this._createButton(),this._addButtonMethods(),this._addObserver(),Object.isElement(this._parentElement)&&this._parentElement.appendChild(this.getButton()),this.updateCaption(this._caption)},_addButtonMethods:function(){this.getButton().updateCaption=this.updateCaption.bind(this),this.getButton().setCaption=this.getButton().updateCaption,this.getButton().getCaption=this.getCaption.bind(this),this.getButton().enable=this.enable.bind(this),this.getButton().disable=this.disable.bind(this)},updateCaption:function(caption){return this._caption=caption.stripTags().stripScripts(),this._setCaption.bind(this).defer()},setCaption:function(caption){this.updateCaption(caption)},_setCaption:function(){var contentElement=this.getContentElement();return contentElement.update(this._caption),this.setWidth(this._getNewButtonWidth(this._caption,contentElement)),this.getButton()},enable:function(){return this.getButton().removeAttribute("disabled"),this.getButton().removeClassName("wjgui_button_disabled"),this},disable:function(){return this.getButton().disabled="disabled",this.getButton().addClassName("wjgui_button_disabled"),this},getContentElement:function(){return this.getButton().down("."+this._getBaseClassName()+"_content")},_getNewButtonWidth:function(text,element){var fontfamily=element.getStyle("fontFamily"),fontweight=(element.getStyle("fontSize"),element.getStyle("fontWeight"));WJButton.measureElement.setStyle({fontFamily:fontfamily,fontSize:"1em",fontWeight:fontweight,whiteSpace:"nowrap"}).update(text),element.appendChild(WJButton.measureElement);var width=WJButton.measureElement.getWidth();return WJButton.measureElement.remove(),width+=this.getWidth()-element.getWidth(),width>100||this.getButton().up("div.autowidth",0)?width:100},getWidth:function(){return this.getButton().getWidth()},setWidth:function(width){this.getButton().setStyle({width:width+"px"})},_buildEventHandler:function(){if(!Object.isFunction(this._eventHandler)&&-1==this._eventHandler.indexOf(":")){this._eventHandler=this._getEventPrefix()+":"+this._eventHandler,this._log("INFO","Build event handler for this, create event "+this._eventHandler);var func=function(event,eventHandler,wjbutton){wjbutton._log("INFO","Fire event in WJButton",event,eventHandler),Event.element(event).fire(eventHandler)}.bindAsEventListener(this.getButton(),this._eventHandler,this);this._eventHandler=func}},_getEventPrefix:function(){return"wjgui"},_createButton:function(){this._buttonElement=new Element("button");var template=this._getTemplate(),replaces={};replaces.classprefix=this._getBaseClassName(),this._buttonElement.addClassName(replaces.classprefix+" "+replaces.classprefix+"_"+(this._defaultButton?"":"no")+"default"),this._buttonElement.innerHTML=template.evaluate(replaces)},_getBaseClassName:function(){return"wjgui_button"},_getTemplate:function(){return new Template("<div class='#{classprefix}_left #{classprefix}_column'><div class='#{classprefix}_right #{classprefix}_column'><div class='#{classprefix}_center #{classprefix}_column'><div class='#{classprefix}_content'>&#160;</div></div></div></div>")},getButton:function(){return this._buttonElement},_addObserver:function(){this._log("INFO","_addObserver in WJButton",this._eventHandler),this._log("DEBUG","WJButton observer code",this._eventHandler.toString()),Event.observe(this.getButton(),"click",this._eventHandler)},setObserver:function(eventHandler){Event.stopObserving(this.getButton(),"click",this._eventHandler),this._eventHandler=eventHandler,this._addObserver()},getCaption:function(){return this._caption},recalculateWidth:function(){this.updateCaption(this.getCaption())},_log:function(level){return"undefined"!=typeof WJDebugger?(arguments[0]=WJDebugger[level],WJDebugger.log.apply(this,arguments)):void 0}});WJButton.measureElement=new Element("div",{style:"position: absolute; left: -5000px;"}),WJButton.create=function(caption,eventHandler,defaultButton,parentElement){var button=new WJButton(caption,eventHandler,defaultButton,parentElement);return button.getButton()},WJButton.toWJButtonStyle=function(element,defaultButton){if("button"==element.tagName.toLowerCase()){var element=$(element),caption=element.getTextContent(),template=WJButton.prototype._getTemplate(),replaces={classprefix:WJButton.prototype._getBaseClassName()};element.className=replaces.classprefix+" "+replaces.classprefix+"_"+(defaultButton?"":"no")+"default",element.update(template.evaluate(replaces)),element.down("."+replaces.classprefix+"_content").update(caption)}return element};var WJModalLayer=Class.create({initialize:function(parent,modalLayer,fillviewport,hidescroll){var parent=parent||document.body;this.fillviewport=fillviewport||!1,this.hidescroll=hidescroll||!1,this._modalLayer=modalLayer||new Element("div"),$(this._modalLayer).addClassName("wjgui_window_modality"),$(parent).appendChild(this._modalLayer),this._removed=!1,this._absolutizeTopLeft(),this._fillViewport(),Event.observe(window,"resize",this._fillViewport.bind(this,this._modalLayer))},_absolutizeTopLeft:function(element){var element=this._modalLayer;element.absolutize(),element.setStyle({left:0,top:0,zIndex:2147483647})},_fillViewport:function(){this.hidescroll&&(this.inlineStyling=$(document.body).readAttribute("style"),$(document.body).setStyle({overflow:"hidden"}));var element=$(this._modalLayer);!this.fillviewport&&$(element.parentNode)&&$(element.parentNode).getHeight?element.setStyle({width:$(element.parentNode).getWidth()+"px",height:$(element.parentNode).getHeight()+"px"}):element.setStyle({width:document.viewport.getWidth()+"px",height:document.viewport.getHeight()+"px",top:$(document.body).cumulativeScrollOffset().top+"px"}),this._modalLayer.fire("wjmodallayer:viewportfilled")},getLayer:function(){return this._modalLayer},destroy:function(){this._removed||(this._modalLayer.remove(),this._removed=!0,this.hidescroll&&document.body.setAttribute("style",this.inlineStyling))}}),WJWindowBooleanConfirm=Class.create(WJWindowConfirm,{initialize:function($super,toDecorate){this._type="booleanconfirm",$super(toDecorate)},_addButtons:function($super){return this._buttons=$super(),this._buttons.get("ok").updateCaption(this._decorated.translate("YES")),this._buttons.get("cancel").updateCaption(this._decorated.translate("NO")),this._buttons}}),WJWindowGooglemaps=Class.create({initialize:function(toDecorate,kmlname,sitename){this._decorate(toDecorate),this._addClassNames(kmlname,sitename),"undefined"!=typeof kmlname&&this.setTheme(kmlname),this._addPushpinWindowConnector(),this._saveStyleSettings(),this.removeListener("true")},_addPushpinWindowConnector:function(){this._pushpinwindowconnector=new Element("div",{style:"position: absolute;"}),this._pushpinwindowconnector.addClassName("pushpinwindowconnector"),this.getWindowElement().insert(new Element("div",{style:"position: relative; overflow: visible; height: 0px; width: 0px;"}).insert(this._pushpinwindowconnector))},getPushpinWindowConnectorElement:function(){return this._pushpinwindowconnector},_saveStyleSettings:function(){var wasVisible=this.isVisible(),origX=this.getX(),origY=this.getY();wasVisible||(this.setX(-1e4),this.setY(-1e4),this.show()),this._stylesettings=new Hash;var top=null!=this._pushpinwindowconnector.getStyle("top")?parseInt(this._pushpinwindowconnector.getStyle("top")):0;this._stylesettings.set("pushpinwindowconnector-top",top);var left=null!=this._pushpinwindowconnector.getStyle("left")?parseInt(this._pushpinwindowconnector.getStyle("left")):0;this._stylesettings.set("pushpinwindowconnector-left",left),this._stylesettings.set("pushpinwindowconnector-height",this._pushpinwindowconnector.getHeight()),wasVisible||(this.hide(),this.setX(origX),this.setY(origY))},getStyleSetting:function(setting){return this._stylesettings.get(setting)},_addClassNames:function(kmlname,sitename){var classname=this._getBaseClassname()+"_googlemaps",element=this.getWindowElement();element.addClassName(classname),"undefined"!=typeof sitename&&element.addClassName(classname+"_"+sitename)},_decorate:function(toDecorate){this._decorated=toDecorate;for(property in this._decorated)Object.isFunction(this[property])||(this[property]=this._decorated[property])},fireClose:function(element){this.hide()},getFullHeight:function(){return this.getHeight()+(this._stylesettings.get("pushpinwindowconnector-height")+this._stylesettings.get("pushpinwindowconnector-top"))}}),WJWindowNotice=Class.create(WJWindowAlert,{initialize:function($super,toDecorate){this._type="notice",$super(toDecorate)}}),WJWindowPrompt=Class.create(WJWindowMessageDialog,{initialize:function($super,toDecorate){this._type="prompt",$super(toDecorate),this.getInput().focus()},_getTemplate:function($super){var template=$super();return template.template+="<input/>",template},_addButtons:function($super){$super(),WJButton.create(this._decorated.translate("CANCEL"),"false",!1,this.getContentElement("buttons"))},windowResult:function(event,result){result?this._callback(event,this.getInput().value):this._callback(event,"")},getInput:function(){return this._input||(this._input=this.getWindowElement().getElementsByTagName("input")[0]),this._input}}),WJWrappedPane=Class.create({initialize:function(element){this.element=$(element),WJDebugger.log(WJDebugger.INFO,"Create new wrapped pane",element),$(this.element.parentNode).insertBefore(this._createWrapper(),this.element).down(".wjgui_wrappedpane_main").down(".wjgui_wrappedpane_content").update("").appendChild(this.element)},_createWrapper:function(){var template=new Template("<div class='wjgui_wrappedpane_#{rowname}'><div class='wjgui_wrappedpane_left wjgui_wrappedpane_column'><div class='wjgui_wrappedpane_right wjgui_wrappedpane_column'><div class='wjgui_wrappedpane_center wjgui_wrappedpane_column'><div class='wjgui_wrappedpane_content'>&#160;</div></div></div></div></div>"),content=["top","main","bottom"].inject("",function(content,rowname){return content+template.evaluate({rowname:rowname})}),wrappedpane=new Element("div").update(content);return wrappedpane.addClassName("wjgui_wrappedpane"),wrappedpane}});